---
import '../../styles/buttons.css';

interface Props {
  platform: string;
  url: string;
  bgColor?: string; // optional background color (hex, rgb, var, etc.)
  icon?: string; // optional icon filename in /public/icons, e.g. "github.svg"
  class?: string; // allow extra classes from parent
}

const { platform, url, bgColor, icon, class: className, ...rest } = Astro.props as Props & Record<string, any>;
// Preserve explicit protocols (http/https/mailto/tel) and absolute/relative paths; otherwise prefix with https://
const href = /^(https?:|mailto:|tel:|\/)/.test(url) ? url : `https://${url}`;
// If an icon is provided, force a dim white background for contrast with the logo
const baseBg = bgColor ?? 'var(--accent, #4c1d95)';
const resolvedBg = icon ? 'rgba(255,255,255,0.85)' : baseBg;
---
<a class={`btn social${className ? ' ' + className : ''}`} href={href} style={`--social-bg: ${resolvedBg}`} {...rest}> 
  {icon ? (
    <img src={`/icons/${icon}`} alt={platform} width="18" height="18" loading="lazy" />
  ) : null}
  <span class="label">{platform}</span>
</a>

<style>
  .social { background-color: var(--social-bg); }
  .social img {
    display: block;
    width: 18px;
    height: 18px;
  }
  .label {
    font-size: var(--font-2);
    font-weight: 500;
  } 
</style>